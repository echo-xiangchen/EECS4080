indices_of(a: ARRAY[INTEGER]; value: INTEGER): ARRAY[INTEGER]
require
	not_empty: a.count > 0
local
	i: INTEGER
	j: INTEGER
do
	from
		i := 1;
		j := 1;
	invariant
		j <= i
	until
		i > a.upper
	loop
		if a[i] = value then
			Result[j] := i;
			j := j + 1;
		end
		i := i + 1;
	variant
		loop_variant: a.upper - i + 1
	end
ensure
	-- discharged postcondition
	case1: exists k1: INTEGER | a[k1] = value => exists s1:INTEGER | Result[s1] = k1
end

verify indices_of