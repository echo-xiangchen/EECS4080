\documentclass{article}

\usepackage{hhline}
\usepackage{amssymb}
\usepackage{caption}
%\usepackage{subcaption}
\usepackage{subfigure}
\usepackage{multirow}
\usepackage{paralist}
\usepackage{algorithm2e}
\usepackage{amsmath}
\usepackage{verbatim}
%\usepackage{program}
\setcounter{tocdepth}{3}
\usepackage{graphicx}
\usepackage[table]{xcolor}
\usepackage{url}
\usepackage[T1]{fontenc}
\usepackage[final]{changes}

\definechangesauthor[color=orange]{lp}
\definechangesauthor[color=green]{ml}
\definechangesauthor[color=blue]{jw}
\definechangesauthor[color=red]{aw}




\urldef{\mailsa}\path|{alfred.hofmann, ursula.barth, ingrid.haas, frank.holzwarth,|
\urldef{\mailsb}\path|anna.kramer, leonie.kunz, christine.reiss, nicole.sator,|
\urldef{\mailsc}\path|erika.siebert-cole, peter.strasser, lncs}@springer.com|    
%\newcommand{\keywords}[1]{\par\addvspace\baselineskip
%\noindent\keywordname\enspace\ignorespaces#1}
\include{macro}
\usepackage{fancyvrb, courier} % for fancyvrb
\renewcommand\ttdefault{txtt}
\DefineVerbatimEnvironment{code}{Verbatim}{frame=none, framesep=10mm, fontsize=\small, commandchars=\\\{\}}
\newcommand{\pre}[1]{#1$_{-1}$}
\newcommand{\bigbrace}[1]{
    \left( 
        \begin{array}{l}
        #1
        \end{array} 
    \right)
}
\newcommand\verbbf{\textcolor[rgb]{1,1,0}}

\usepackage{wrapfig}
\usepackage{listings}
\lstset{
  basicstyle=\small\ttfamily,
  frame=lrtb,
  numbers=left
}

\lstdefinelanguage{pvs}
{morekeywords={THEORY,FORALL,THEOREM,EXISTS,IF,ELSE,THEN,ENDIF,TABLE,ENDTABLE,COND,ENDCOND,IMPLIES,LEMMA,LET,IN,RECURSIVE,MEASURE,DO,TO,BY,FOR,END_FOR,VAR_INPUT,VAR_OUTPUT,VAR,END_VAR,TYPE,TRUE,FALSE,IMPORTING,END,ELSIF},
sensitive=false,
morecomment=[l]{\%},
morecomment=[s]{/*}{*/},
morestring=[b]",
}
\usepackage[b4paper]{geometry}

\begin{document}

\begin{lstlisting}[language=pvs,numbers=none]
% Inputs
XIN1, XIN2 : VAR [tick -> real]
EPS        : VAR [tick -> posreal] % Assumption: positive deadband size

% Output
Q          : VAR [tick -> bool]

HYSTERESIS_st_impl (XIN1, XIN2, EPS, Q): bool =
  FORALL t:
    Q(t) = 
      IF    init(t)                                  THEN False
      ELSIF Q(pre(t)) & XIN1(t) < (XIN2(t) - EPS(t)) THEN False
      ELSIF             XIN1(t) > (XIN2(t) + EPS(t)) THEN True
      ELSE                                                Q(pre(t))
      ENDIF
\end{lstlisting}

\begin{lstlisting}[language=pvs,numbers=none]
HYSTERESIS_tab_req (XIN1, XIN2, EPS, Q): bool =
  FORALL t:
    Q(t) = 
      IF init(t) THEN False
      ELSE LET prev = Q(pre(t)) IN
       TABLE
        | XIN1(t) < (XIN2(t) - EPS(t))                                  | False ||
        | (XIN2(t) - EPS(t)) <= XIN1(t) & XIN1(t) <= (XIN2(t) + EPS(t)) | prev  ||
        | (XIN2(t) + EPS(t)) < XIN1(t)                                  | True  ||
       ENDTABLE
      ENDIF
\end{lstlisting}

\begin{lstlisting}[language=pvs,numbers=none]
Hysteresis_correctness: THEOREM 
  FORALL XIN1, XIN2, EPS, Q:
    HYSTERESIS_st_impl(XIN1, XIN2, EPS, Q) IMPLIES 
      HYSTERESIS_tab_req(XIN1, XIN2, EPS, Q)

Hysteresis_consistency: THEOREM
  FORALL XIN1, XIN2, EPS:
    EXISTS Q:
      HYSTERESIS_st_impl(XIN1, XIN2, EPS, Q)
\end{lstlisting}

\clearpage

\begin{lstlisting}[language=pvs,numbers=none]
% Assumption: low and high alarm hysteresis regions do not overlap
HIGH_LIMIT: TYPE = 
  [ l: [tick -> real], eps: [tick -> posreal] -> 
      { h: [tick -> real] | FORALL (t: tick): h(t) - eps(t) > l(t) + eps(t) } ]

% Inputs
X, L      : VAR [tick -> real]
EPS       : VAR [tick -> posreal]
H         : VAR HIGH_LIMIT

% Outputs
QH, Q, QL : VAR [tick -> bool]

LIMITS_ALARM_fbd_impl (X, H, L, EPS, QH, Q, QL): bool =
  EXISTS (w1: [tick -> posreal]), (w2, w3: [tick -> real]):
      DIV(EPS, (LAMBDA (t: tick): 2.0), w1) 
    & SUB(H(L, EPS), w1, w2) 
    & ADD(L, w1, w3) 
    & HYSTERESIS_tab_req(X, w2, w1, QH) 
    & HYSTERESIS_tab_req(w3, x, w1, QL)
    & DISJ(QH, QL, Q) 
\end{lstlisting}

\begin{lstlisting}[language=pvs,numbers=none]
LIMITS_ALARM_correctness: THEOREM
  FORALL X, H, L, EPS, QH, Q, QL:
    LIMITS_ALARM_fbd_impl(H, X, L, EPS, QH, Q, QL) IMPLIES 
      LIMITS_ALARM_tab_req(H, X, L, EPS, QH, Q, QL)

LIMITS_ALARM_consistency: THEOREM
  FORALL H, X, L, EPS:
    EXISTS QH, Q, QL:
      LIMITS_ALARM_fbd_impl(H, X, L, EPS, QH, Q, QL)
\end{lstlisting}

\end{document}